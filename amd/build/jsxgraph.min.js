define("qtype_stack/jsxgraph",["qtype_stack/jsxgraphcore-lazy"],(function(JXG){var serializers={},deserializers={},initials={},objectgroups=[],objectinput={},registeredobjects={},active=!1;function pointserializer(point){return JSON.stringify([point.X(),point.Y()])}function pointdeserializerparsed(point,data){try{"number"==typeof data[0]&&"number"==typeof data[1]&&(point.setPosition(JXG.COORDS_BY_USER,data),point.board.update(),point.update())}catch(err){}}function generalobjectupdatehandlerid(id){if(!active){active=!0;try{var handledinputs=[];if(id in objectinput)for(var i=0;i<objectinput[id].length;i++){var inputname=objectinput[id][i];if(-1===handledinputs.indexOf(inputname)){handledinputs.push(inputname);var input=document.getElementById(inputname),val=serializers[inputname][id]();if(val===initials[inputname])return void(active=!1);initials[inputname]=null,input.value=val}}for(var gi=0;gi<objectgroups.length;gi++){var group=objectgroups[gi];if(-1!==group.indexOf(id))for(var gt=0;gt<group.length;gt++){var obj=group[gt];if(obj!==id&&obj in objectinput)for(i=0;i<objectinput[obj].length;i++){inputname=objectinput[obj][i];if(-1===handledinputs.indexOf(inputname))initials[inputname]=null,handledinputs.push(inputname),(input=document.getElementById(inputname)).value=serializers[inputname][obj]()}}}for(i=0;i<handledinputs.length;i++){input=document.getElementById(handledinputs[i]);if(-1===window.location.pathname.indexOf("preview.php")){var e=new Event("change");input.dispatchEvent(e)}e=new Event("input");input.dispatchEvent(e)}}catch(err){}active=!1}}function generalinputupdatehandler(inputname){if(inputname in deserializers){for(var input=document.getElementById(inputname),keys=Object.keys(serializers[inputname]),ok=!1,i=0;i<keys.length;i++){serializers[inputname][keys[i]]()!==input.value&&(ok=!0,i=keys.length+1)}if(ok)for(i=0;i<deserializers[inputname].length;i++)deserializers[inputname][i](input.value)}}return{find_input_id:function(divid,name){for(var tmp=document.getElementById(divid);(tmp=tmp.parentElement)&&(!tmp.classList.contains("formulation")||!tmp.parentElement.classList.contains("content")););return(tmp=tmp.querySelector('input[id$="_'+name+'"]')).addEventListener("change",(function(){M.core_formchangechecker.set_form_changed()})),tmp.id},define_group:function(list){for(var l=[],i=0;i<list.length;i++)-1===l.indexOf(list[i].id)&&l.push(list[i].id);objectgroups.push(l)},starts_moved:function(obj){if(obj.id in objectinput){for(var i=0;i<objectinput[obj.id].length;i++)initials[objectinput[obj.id][i]]=null;generalobjectupdatehandlerid(obj.id)}},custom_bind:function(input,serializer,deserializer,objects){!function(inputname){if(!(inputname in serializers)){serializers[inputname]={},deserializers[inputname]=[];var input=document.getElementById(inputname);input.addEventListener("input",(function(){return generalinputupdatehandler(inputname)})),input.addEventListener("change",(function(){return generalinputupdatehandler(inputname)})),input.addEventListener("change",(function(){M.core_formchangechecker.set_form_changed()}))}}(input),initials[input]=serializer();var theInput=document.getElementById(input);theInput.value&&""!=theInput.value&&deserializer(theInput.value),deserializers[input].push(deserializer);for(var i=0;i<objects.length;i++)this.register_object(input,objects[i],serializer)},register_object:function(input,object,serializer){object.id in objectinput?input in objectinput[object.id]||objectinput[object.id].push(input):objectinput[object.id]=[input],serializers[input][object.id]=serializer,function(object){object.id in registeredobjects||(object.board.on("update",(function(){return generalobjectupdatehandlerid(object.id)})),registeredobjects[object.id]=object)}(object)},bind_point:function(inputRef,point){this.custom_bind(inputRef,(function(){return pointserializer(point)}),(function(value){return function(point,data){try{var tmp=JSON.parse(data);"number"==typeof tmp[0]&&"number"==typeof tmp[1]&&(point.setPosition(JXG.COORDS_BY_USER,tmp),point.board.update(),point.update())}catch(err){}}(point,value)}),[point])},bind_point_dual:function(inputRef,p1,p2){this.custom_bind(inputRef,(function(){return JSON.stringify([[p1.X(),p1.Y()],[p2.X(),p2.Y()]])}),(function(value){var tmp=JSON.parse(value);pointdeserializerparsed(p1,tmp[0]),pointdeserializerparsed(p2,tmp[1])}),[p1,p2])},bind_point_relative:function(inputRef,p1,p2){this.custom_bind(inputRef,(function(){return JSON.stringify([[p1.X(),p1.Y()],[p2.X()-p1.X(),p2.Y()-p1.Y()]])}),(function(value){var tmp=JSON.parse(value);pointdeserializerparsed(p1,tmp[0]),tmp[1][0]=tmp[1][0]+tmp[0][0],tmp[1][1]=tmp[1][1]+tmp[0][1],pointdeserializerparsed(p2,tmp[1])}),[p1,p2])},bind_point_direction:function(inputRef,p1,p2){this.custom_bind(inputRef,(function(){return JSON.stringify([[p1.X(),p1.Y()],[Math.atan2(p2.Y()-p1.Y(),p2.X()-p1.X()),Math.sqrt((p2.X()-p1.X())*(p2.X()-p1.X())+(p2.Y()-p1.Y())*(p2.Y()-p1.Y()))]])}),(function(value){var tmp=JSON.parse(value);pointdeserializerparsed(p1,tmp[0]);var angle=tmp[1][0],len=tmp[1][1];tmp[1][0]=tmp[0][0]+len*Math.cos(angle),tmp[1][1]=tmp[0][1]+len*Math.sin(angle),pointdeserializerparsed(p2,tmp[1])}),[p1,p2])},bind_slider:function(inputRef,slider){this.custom_bind(inputRef,(function(){return function(slider){return JSON.stringify(slider.Value())}(slider)}),(function(value){return function(slider,data){try{slider.setValue(JSON.parse(data)),slider.board.update(),slider.update()}catch(err){}}(slider,value)}),[slider])},bind_list_of:function(inputRef,list_of_objects){this.custom_bind(inputRef,(function(){for(var r="[",i=0;i<list_of_objects.length;i++){var obj=list_of_objects[i];r="slider"===obj.getType()?r+JSON.stringify(obj.Value())+",":r+pointserializer(obj)+","}return(r=r.substring(0,r.length-1))+"]"}),(function(value){for(var tmp=JSON.parse(value),i=0;i<list_of_objects.length&&i<tmp.length;i++){var obj=list_of_objects[i];"slider"===obj.getType()?obj.setValue(tmp[i]):pointdeserializerparsed(obj,tmp[i])}}),list_of_objects)}}}));

//# sourceMappingURL=jsxgraph.min.js.map